---
title: "**Lab Record**"
author: "**R V Abhishek**"
date: "2025-08-13"
output:
  pdf_document:
    latex_engine: xelatex
    extra_dependencies: ["fancyhdr", "graphicx"]
  html_document:
    theme: "cerulean"
    highlight: "tango"
    number_lines: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE,number.lines = TRUE)
knitr::opts_chunk$set(comment = "")
```

# Lab Program - 1: Program to check what type of Triangle given 3 sides, and calculate its area

This R program validates the sides of the triangle (taken as input from the user) and then if valid, calculates the area of the triangle using Heron's formula and checks what type of triangle it is

```{r}
# Validating the triangle
is_valid_triangle <- function(a, b, c) {
  return ((a + b > c) & (b + c > a) & (a + c > b ))
}
```

```{r}
# Function to check the type of triangle
triangle_type <- function(a , b , c) {
  if (a == b && b == c) {
    return(" Equilateral ")
  } else if ( a == b || b == c || a == c) {
    return(" Isosceles ")
  } else {
    return("Scalene")
  }
}
```

```{r}
# Calculating Area using Heron's Formula
triangle_area <- function(a , b , c) {
  s <- (a + b + c) / 2 # Semi - perimeter
  # Heron ’s formula
  area <- sqrt (s * (s - a) * (s - b) * (s - c))
  return (area)
}
```

```{r}
# Validating inputs
validate_input <- function(x) {
  if (!is.numeric(x) || x <= 0) {
    stop("Error : Input must be a positive number.")
  }
  return(TRUE)
}
```

```{r}
## Main Code Block

# 1. Defining 3 variables representing the 3 sides of the triangle
cat("Enter the lengths of the sides of the triangle :\n") 
a <- as.numeric(readline(prompt = "Side A: ")) 
b <- as.numeric(readline(prompt = "Side B: ")) 
c <- as.numeric(readline(prompt = "Side C: "))
```

```{r}
# 2.  Input Validation and implementation of all the functions.
# Input validation} 
tryCatch ({ 
  validate_input(a) 
  validate_input(b) 
  validate_input(c) 
  
  # Check if the inputs form a valid triangle 
  if (!is_valid_triangle(a , b , c)) { 
    stop("Error : The given sides do not form a valid triangle.")
  }
  
  # Determine the type of triangle 
  type_of_triangle <- triangle_type(a , b , c) 
  cat("The triangle is:", type_of_triangle, "\n") 
  # Calculate the area of the triangle 
  area_of_triangle <- triangle_area(a, b, c) 
  cat("The area of the triangle is:", area_of_triangle, "\n")

}, error = function(e){ 
  cat(e$message, "\n") 
})
```

## Sample Output

```         
Enter the lengths of the sides of the triangle:
Side a: 5
Side b: 5 
Side c: 8

The triangle is: Isosceles 
The area of the triangle is: 12

Enter the lengths of the sides of the triangle:** 
Side a: 1 
Side b: 2
Side c: 8

Error: The given sides do not form a valid triangle.
```

# Lab Program - 2: Creating and Manipulating Data Structures
This program evaluates the student’s understanding of different data structures (vectors, matrices, lists, and data frames) in R and how to manipulate them.

```{r}
# 1. Create a vector of random numbers and apply operations such as sorting and searching

set.seed(42) # For reproducibility
random_vector <- runif(20, min = 1, max = 100) # Vector of 20 random numbers between 1 and 100
cat("Original random vector:\n")
print(random_vector)

# Sort the vector
sorted_vector <- sort(random_vector)
cat("Sorted vector:\n")
print(sorted_vector)

# Search for a specific value (check if a number is present)
search_value <- 50
is_value_present <- any(random_vector == search_value)
cat("Is", search_value, "present in the vector?", is_value_present, "\n")

# Find values in the vector greater than 60
values_greater_than_60 <- random_vector[random_vector > 60]
cat("Values greater than 60:\n")
print(values_greater_than_60)
```

```{r}
# 2. Convert the vector into a matrix and perform matrix multiplication

# Create a 4x5 matrix from the vector
matrix_from_vector <- matrix(random_vector, nrow = 4, ncol = 5)
cat("Matrix from vector:\n")
print(matrix_from_vector)

# Perform matrix multiplication (matrix with its transpose)
matrix_transpose <- t(matrix_from_vector)
matrix_multiplication_result <- matrix_from_vector %*% matrix_transpose
cat("Matrix multiplication result:\n")
print(matrix_multiplication_result)

# Element-wise matrix multiplication (Hadamard product)
elementwise_multiplication_result <- matrix_from_vector * matrix_from_vector
cat("Element-wise matrix multiplication result:\n")
print(elementwise_multiplication_result)
```

```{r}
# 3. Create a list containing different types of elements and perform subsetting

my_list <- list(
  numbers = random_vector,
  characters = c("A", "B", "C", "D"),
  logical_values = c(TRUE, FALSE, TRUE),
  matrix = matrix_from_vector
)
cat("List:\n")
print(my_list)

# Subsetting the list (extracting numeric and logical parts)
subset_numeric <- my_list$numbers
cat("Subset (numeric part of the list):\n", subset_numeric, "\n")

subset_logical <- my_list$logical_values
cat("Subset (logical part of the list):\n", subset_logical, "\n")

# Modify elements in the list (replace the second character with "Z")
my_list$characters[2] <- "Z"
cat("Modified list of characters:\n", my_list$characters, "\n")

# Apply a function to the numeric part of the list (e.g., calculate the square of the numbers)
squared_numbers <- my_list$numbers ^ 2
cat("Squared numbers:\n", squared_numbers, "\n")
```

```{r}
# 4. Create a data frame and perform operations such as filtering, summarizing, and handling missing values
# Create a data frame
df <- data.frame(
  ID = 1:20,
  Age = sample(18:65, 20, replace = TRUE),
  Score = runif(20, min = 50, max = 100),
  Passed = sample(c(TRUE, FALSE), 20, replace = TRUE)
)
cat("Data frame:\n")
print(df)

# Filter the data frame (rows where Age > 30 and Score > 70)
filtered_df <- subset(df, Age > 30 & Score > 70)
cat("Filtered data frame (Age > 30 and Score > 70):\n")
print(filtered_df)

# Calculate mean, sum, and variance of numerical columns (Age and Score)
mean_age <- mean(df$Age)
sum_age <- sum(df$Age)
var_age <- var(df$Age)

mean_score <- mean(df$Score)
sum_score <- sum(df$Score)
var_score <- var(df$Score)

cat("Summary statistics for Age column:\n")
cat("Mean Age:", mean_age, "\n")
cat("Sum of Age:", sum_age, "\n")
cat("Variance of Age:", var_age, "\n")

cat("Summary statistics for Score column:\n")
cat("Mean Score:", mean_score, "\n")
cat("Sum of Score:", sum_score, "\n")
cat("Variance of Score:", var_score, "\n")
```

```{r}
# 5. Handling missing values in the data frame

# Introduce some NA values in the Score column
df$Score[sample(1:20, 5)] <- NA
cat("Data frame with missing values:\n")
print(df)

# Replace NA values with the mean of the Score column
df$Score[is.na(df$Score)] <- mean(df$Score, na.rm = TRUE)
cat("Data frame after imputation of missing values:\n")
print(df)

# Grouping the data by Passed status and calculating group-wise statistics
library(dplyr)
grouped_stats <- df %>%
  group_by(Passed) %>%
  summarise(
    mean_score = mean(Score, na.rm = TRUE),
    mean_age = mean(Age)
  )
cat("Grouped statistics by Passed status:\n")
print(grouped_stats)
```

## Lab Program - 3: Basic Statistical Operations on Open-Source Datasets

*Objective:* This program emphasizes the application of statistical concepts on real-world datasets and visualization of the data.

```{r}
# Load necessary
library(dplyr)  # For data manipulation
library(ggplot2)  # For visualization
library(moments)  # For skewness and kurtosis
library(palmerpenguins) # For Palmer Penguins dataset

data(iris)  # Load Iris dataset

data(penguins)  # Load Palmer Penguins

```

```{r}
# Function to calculate mode
calc_mode <- function(x) {
  return (as.numeric (names (sort (table (x), decreasing = TRUE)) [1] ))
}
```

```{r}
# Perform Statistical Analysis on Iris Dataset
print("----- Iris Dataset Analysis -----")
# Mean
iris_mean <- sapply (iris[, 1:4], mean, na.rm = TRUE )
print(paste("Mean of Iris dataset : ", iris_mean))

#Median
iris_median <- sapply(iris[, 1:4], median, na.rm = TRUE )
print(paste("Median of Iris dataset : ", iris_median))

#Mode
iris_mode <- sapply(iris[, 1:4], calc_mode )
print(paste("Mode of Iris dataset : ", iris_median))

#Variance
iris_variance <- sapply(iris[, 1:4], var, na.rm = TRUE )
print(paste("Variance of Iris dataset : ", iris_variance))

#Standard Deviation
iris_sd <- sapply(iris[, 1:4], sd, na.rm = TRUE )
print(paste("Standard Deviation of Iris dataset : ", iris_sd))

#Skewness
iris_skewness <- sapply(iris[, 1:4], skewness, na.rm = TRUE )
print(paste("Skewness of Iris dataset : ", iris_skewness))
```

```{r}
# Hypothesis Testing (t-test) between Sepal.Length of Setosa and Versicolor
setosa <- subset(iris, Species == "setosa")$Sepal.Length
versicolor <- subset(iris, Species == "versicolor")$Sepal.Length
t_test <- t.test(setosa, versicolor)
print(t_test)
```

```{r}
# Visualization of Iris Dataset
# Histogram for Sepal.Length
ggplot(iris, aes(x = Sepal.Length)) +
  geom_histogram(binwidth = 0.3, fill = "blue", color = "black") +
  ggtitle("Histogram of Sepal Length in Iris Dataset")

# Boxplot for Sepal.Length across Species
ggplot(iris, aes(x = Species, y = Sepal.Length, fill = Species)) +
  geom_boxplot() +
  ggtitle("Boxplot of Sepal Length by Species in Iris Dataset")
```

```{r}
print("----- Palmer Penguins Dataset Analysis -----")

# Remove rows with missing values
penguins_clean <- na.omit(penguins)

# Mean
penguins_mean <- sapply(penguins_clean[, 3:6], mean, na.rm = TRUE)
print(paste("Mean of Palmer Penguins dataset:", penguins_mean))

# Median
penguins_median <- sapply(penguins_clean[, 3:6], median, na.rm = TRUE)
print(paste("Median of Palmer Penguins dataset:", penguins_median))

# Mode
penguins_mode <- sapply(penguins_clean[, 3:6], calc_mode)
print(paste("Mode of Palmer Penguins dataset:", penguins_mode))

# Variance
penguins_variance <- sapply(penguins_clean[, 3:6], var, na.rm = TRUE)
print(paste("Variance of Palmer Penguins dataset:", penguins_variance))

# Standard Deviation
penguins_sd <- sapply(penguins_clean[, 3:6], sd, na.rm = TRUE)
print(paste("Standard Deviation of Palmer Penguins dataset:", penguins_sd))

# Skewness
penguins_skewness <- sapply(penguins_clean[, 3:6], skewness, na.rm = TRUE)
print(paste("Skewness of Palmer Penguins dataset:", penguins_skewness))

# Kurtosis
penguins_kurtosis <- sapply(penguins_clean[, 3:6], kurtosis, na.rm = TRUE)
print(paste("Kurtosis of Palmer Penguins dataset:", penguins_kurtosis))
```

```{r}
# Hypothesis Testing (t-test) between flipper_length_mm of Adelie and Gentoo species
adelie <- subset(penguins_clean, species == "Adelie")$flipper_length_mm
gentoo <- subset(penguins_clean, species == "Gentoo")$flipper_length_mm
t_test_penguins <- t.test(adelie, gentoo)
print(t_test_penguins)
```

```{r}
# Visualization of Palmer Penguins Dataset
# Histogram for flipper_length_mm
ggplot(penguins_clean, aes(x = flipper_length_mm)) +
  geom_histogram(binwidth = 3, fill = "green", color = "black") +
  ggtitle("Histogram of Flipper Length in Palmer Penguins Dataset")

# Boxplot for flipper_length_mm across Species
ggplot(penguins_clean, aes(x = species, y = flipper_length_mm, fill = species)) +
  geom_boxplot() +
  ggtitle("Boxplot of Flipper Length by Species in Palmer Penguins Dataset")
```



